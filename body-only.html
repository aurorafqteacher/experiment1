<script>
  // This is the only script tag you should need to edit

  // If a question does not define tolerance - this value is used
  const defaultTolerance = 0.05;

  // Configuration: How many random questions to show (0 = show all)
  const numberOfQuestionsToShow = 5; // Change this number as needed

  // JSON data structure containing all questions
  const questionsData = [
    {
      title: "Globus Aerostàtic",
      description: "Un globus meteorològic conté <strong>2,5 L</strong> de gas a <strong>20°C (293 K)</strong> i <strong>1 atm</strong>. Si s'eleva i la pressió baixa a <strong>0,6 atm</strong>, quin volum ocuparà el gas?",
      inputLabel: "Volum final (L):",
      correctAnswer: 4.17,
      tolerance: 0.05,
      correctLaw: "B",
      solution: `Dades: V₁=2,5 L; P₁=1 atm; P₂=0,6 atm; T constant.
Llei de Boyle: P₁·V₁=P₂·V₂ → V₂ = P₁·V₁ / P₂.
Càlcul: V₂ = 1·2,5 / 0,6 ≈ 4,17 L.
El volum augmenta perquè la pressió disminueix.`
    },
    {
      title: "Bomba d'Aire",
      description: "Una bomba d'aire comprimeix <strong>5 L</strong> d'aire a <strong>1 atm</strong> fins a un volum de <strong>1,5 L</strong>. Quina serà la pressió final?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 3.33,
      tolerance: 0.05,
      correctLaw: "B",
      solution: `Dades: V₁=5 L; P₁=1 atm; V₂=1,5 L; T constant.
Llei de Boyle: P₁·V₁=P₂·V₂ → P₂ = P₁·V₁ / V₂.
Càlcul: P₂ = 1·5 / 1,5 ≈ 3,33 atm.
La pressió augmenta en comprimir el gas.`
    },
    {
      title: "Escalfament Solar",
      description: "Un gas en un recipient conté <strong>3,2 L</strong> a <strong>25°C (298 K)</strong>. Si s'escalfa pel sol fins a <strong>75°C (348 K)</strong> mantenint la pressió constant, quin serà el nou volum?",
      inputLabel: "Volum final (L):",
      correctAnswer: 3.74,
      tolerance: 0.05,
      correctLaw: "C",
      solution: `Dades: V₁=3,2 L; T₁=298 K; T₂=348 K; P constant.
Llei de Charles: V₁/T₁=V₂/T₂ → V₂ = V₁·T₂ / T₁.
Càlcul: V₂ = 3,2·348 / 298 ≈ 3,74 L.
El volum augmenta amb la temperatura.`
    },
    {
      title: "Refredament Hivernal",
      description: "Un pneumàtic té <strong>45 L</strong> d'aire a <strong>20°C (293 K)</strong>. A l'hivern, la temperatura baixa a <strong>-10°C (263 K)</strong>. Quin volum ocuparà l'aire?",
      inputLabel: "Volum final (L):",
      correctAnswer: 40.41,
      tolerance: 0.1,
      correctLaw: "C",
      solution: `Dades: V₁=45 L; T₁=293 K; T₂=263 K; P constant.
Llei de Charles: V₁/T₁=V₂/T₂ → V₂ = V₁·T₂ / T₁.
Càlcul: V₂ = 45·263 / 293 ≈ 40,41 L.
El volum disminueix amb la temperatura.`
    },
    {
      title: "Escalfament d'Aire",
      description: "L'aire d'una habitació passa de <strong>18°C (291 K)</strong> a <strong>28°C (301 K)</strong> en un recipient rígid de <strong>50 L</strong>. Si la pressió inicial era <strong>1,2 atm</strong>, quina serà la final?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 1.24,
      tolerance: 0.02,
      correctLaw: "G",
      solution: `Dades: P₁=1,2 atm; T₁=291 K; T₂=301 K; V constant.
Llei de Gay-Lussac: P₁/T₁=P₂/T₂ → P₂ = P₁·T₂ / T₁.
Càlcul: P₂ = 1,2·301 / 291 ≈ 1,24 atm.
La pressió augmenta amb la temperatura.`
    },
    {
      title: "Botella de Gas",
      description: "Una botella de gas té una pressió de <strong>8 atm</strong> a <strong>25°C (298 K)</strong>. Si es refreda fins a <strong>0°C (273 K)</strong>, quina serà la nova pressió?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 7.32,
      tolerance: 0.05,
      correctLaw: "G",
      solution: `Dades: P₁=8 atm; T₁=298 K; T₂=273 K; V constant.
Llei de Gay-Lussac: P₁/T₁=P₂/T₂ → P₂ = P₁·T₂ / T₁.
Càlcul: P₂ = 8·273 / 298 ≈ 7,32 atm.
La pressió disminueix amb la temperatura.`
    },
    {
      title: "Submarí",
      description: "Un submarí té una bombolla d'aire de <strong>0,8 L</strong> a <strong>3 atm</strong> de pressió. Si puja a la superfície on la pressió és <strong>1 atm</strong>, quin volum tindrà la bombolla?",
      inputLabel: "Volum final (L):",
      correctAnswer: 2.4,
      tolerance: 0.05,
      correctLaw: "B",
      solution: `Dades: V₁=0,8 L; P₁=3 atm; P₂=1 atm; T constant.
Llei de Boyle: P₁·V₁=P₂·V₂ → V₂ = P₁·V₁ / P₂.
Càlcul: V₂ = 3·0,8 / 1 = 2,4 L.
El volum augmenta en disminuir la pressió.`
    },
    {
      title: "Jeringa Mèdica",
      description: "Una jeringa conté <strong>20 mL</strong> d'aire a <strong>1 atm</strong>. Si es comprimeix fins a <strong>5 mL</strong>, quina pressió s'assoleix?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 4.0,
      tolerance: 0.1,
      correctLaw: "B",
      solution: `Dades: V₁=20 mL; P₁=1 atm; V₂=5 mL; T constant.
Llei de Boyle: P₁·V₁=P₂·V₂ → P₂ = P₁·V₁ / V₂.
Càlcul: P₂ = 1·20 / 5 = 4 atm.
La pressió augmenta en comprimir el gas.`
    },
    {
      title: "Globus d'Heli",
      description: "Un globus d'heli té <strong>2 L</strong> a <strong>15°C (288 K)</strong>. Si es porta a l'interior a <strong>22°C (295 K)</strong>, quin volum tindrà?",
      inputLabel: "Volum final (L):",
      correctAnswer: 2.05,
      tolerance: 0.02,
      correctLaw: "C",
      solution: `Dades: V₁=2 L; T₁=288 K; T₂=295 K; P constant.
Llei de Charles: V₁/T₁=V₂/T₂ → V₂ = V₁·T₂ / T₁.
Càlcul: V₂ = 2·295 / 288 ≈ 2,05 L.
El volum augmenta lleugerament amb la temperatura.`
    },
    {
      title: "Cuina a Pressió",
      description: "Una olla a pressió té vapor d'aigua a <strong>2,5 atm</strong> i <strong>120°C (393 K)</strong>. Si es refreda fins a <strong>100°C (373 K)</strong>, quina serà la pressió?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 2.37,
      tolerance: 0.05,
      correctLaw: "G",
      solution: `Dades: P₁=2,5 atm; T₁=393 K; T₂=373 K; V constant.
Llei de Gay-Lussac: P₁/T₁=P₂/T₂ → P₂ = P₁·T₂ / T₁.
Càlcul: P₂ = 2,5·373 / 393 ≈ 2,37 atm.
La pressió disminueix en refredar-se.`
    },
    {
      title: "Laboratori Criogènic",
      description: "Un gas a <strong>-50°C (223 K)</strong> ocupa <strong>1,8 L</strong>. Si s'escalfa fins a <strong>50°C (323 K)</strong>, quin volum ocuparà?",
      inputLabel: "Volum final (L):",
      correctAnswer: 2.61,
      tolerance: 0.05,
      correctLaw: "C",
      solution: `Dades: V₁=1,8 L; T₁=223 K; T₂=323 K; P constant.
Llei de Charles: V₁/T₁=V₂/T₂ → V₂ = V₁·T₂ / T₁.
Càlcul: V₂ = 1,8·323 / 223 ≈ 2,61 L.
Gran augment de volum per l'escalfament.`
    },
    {
      title: "Bomba de Bicicleta",
      description: "En bombar aire, es comprimeixen <strong>300 mL</strong> a <strong>1 atm</strong> fins a <strong>50 mL</strong>. Quina pressió es genera?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 6.0,
      tolerance: 0.1,
      correctLaw: "B",
      solution: `Dades: V₁=300 mL; P₁=1 atm; V₂=50 mL; T constant.
Llei de Boyle: P₁·V₁=P₂·V₂ → P₂ = P₁·V₁ / V₂.
Càlcul: P₂ = 1·300 / 50 = 6 atm.
Alta pressió per la gran compressió.`
    },
    {
      title: "Motor de Cotxe",
      description: "Els gasos del motor passen de <strong>600°C (873 K)</strong> a <strong>200°C (473 K)</strong> en un cilindre fix. Si la pressió inicial era <strong>15 atm</strong>, quina serà la final?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 8.13,
      tolerance: 0.1,
      correctLaw: "G",
      solution: `Dades: P₁=15 atm; T₁=873 K; T₂=473 K; V constant.
Llei de Gay-Lussac: P₁/T₁=P₂/T₂ → P₂ = P₁·T₂ / T₁.
Càlcul: P₂ = 15·473 / 873 ≈ 8,13 atm.
La pressió disminueix en refredar-se els gasos.`
    },
    {
      title: "Bucejador",
      description: "Un bucejador exhala <strong>0,5 L</strong> d'aire a <strong>4 atm</strong> de profunditat. Quin volum tindrà aquesta bombolla a la superfície (<strong>1 atm</strong>)?",
      inputLabel: "Volum final (L):",
      correctAnswer: 2.0,
      tolerance: 0.05,
      correctLaw: "B",
      solution: `Dades: V₁=0,5 L; P₁=4 atm; P₂=1 atm; T constant.
Llei de Boyle: P₁·V₁=P₂·V₂ → V₂ = P₁·V₁ / P₂.
Càlcul: V₂ = 4·0,5 / 1 = 2 L.
La bombolla es quadruplica en pujar.`
    },
    {
      title: "Congelador Industrial",
      description: "Un gas passa de <strong>25°C (298 K)</strong> a <strong>-80°C (193 K)</strong> en un recipient rígid. Si la pressió inicial era <strong>3 atm</strong>, quina serà la final?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 1.94,
      tolerance: 0.05,
      correctLaw: "G",
      solution: `Dades: P₁=3 atm; T₁=298 K; T₂=193 K; V constant.
Llei de Gay-Lussac: P₁/T₁=P₂/T₂ → P₂ = P₁·T₂ / T₁.
Càlcul: P₂ = 3·193 / 298 ≈ 1,94 atm.
Gran disminució de pressió pel refredament extrem.`
    },
    {
      title: "Bombolla de Sabó",
      description: "Una bombolla de sabó té <strong>0,1 L</strong> a <strong>1 atm</strong>. Si la pressió atmosfèrica canvia a <strong>0,95 atm</strong>, quin volum tindrà?",
      inputLabel: "Volum final (L):",
      correctAnswer: 0.105,
      tolerance: 0.002,
      correctLaw: "B",
      solution: `Dades: V₁=0,1 L; P₁=1 atm; P₂=0,95 atm; T constant.
Llei de Boyle: P₁·V₁=P₂·V₂ → V₂ = P₁·V₁ / P₂.
Càlcul: V₂ = 1·0,1 / 0,95 ≈ 0,105 L.
La bombolla s'expandeix lleugerament.`
    },
    {
      title: "Assecador de Cabells",
      description: "L'aire d'un assecador passa de <strong>20°C (293 K)</strong> a <strong>60°C (333 K)</strong>. Si inicialment ocupa <strong>0,5 L</strong>, quin volum tindrà escalfat?",
      inputLabel: "Volum final (L):",
      correctAnswer: 0.568,
      tolerance: 0.01,
      correctLaw: "C",
      solution: `Dades: V₁=0,5 L; T₁=293 K; T₂=333 K; P constant.
Llei de Charles: V₁/T₁=V₂/T₂ → V₂ = V₁·T₂ / T₁.
Càlcul: V₂ = 0,5·333 / 293 ≈ 0,568 L.
L'aire escalfat s'expandeix.`
    },
    {
      title: "Calderes Industrials",
      description: "Una caldera té vapor a <strong>3 atm</strong> i <strong>150°C (423 K)</strong>. Si es refreda a <strong>100°C (373 K)</strong>, quina pressió tindrà?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 2.65,
      tolerance: 0.05,
      correctLaw: "G",
      solution: `Dades: P₁=3 atm; T₁=423 K; T₂=373 K; V constant.
Llei de Gay-Lussac: P₁/T₁=P₂/T₂ → P₂ = P₁·T₂ / T₁.
Càlcul: P₂ = 3·373 / 423 ≈ 2,65 atm.
La pressió del vapor disminueix.`
    },
    {
      title: "Experiment de Laboratori",
      description: "Es comprimeix <strong>100 mL</strong> de gas de <strong>1 atm</strong> a <strong>2,5 atm</strong>. Quin volum ocuparà?",
      inputLabel: "Volum final (mL):",
      correctAnswer: 40,
      tolerance: 1,
      correctLaw: "B",
      solution: `Dades: V₁=100 mL; P₁=1 atm; P₂=2,5 atm; T constant.
Llei de Boyle: P₁·V₁=P₂·V₂ → V₂ = P₁·V₁ / P₂.
Càlcul: V₂ = 1·100 / 2,5 = 40 mL.
El volum es redueix per la compressió.`
    },
    {
      title: "Estufa de Gas",
      description: "El gas d'una estufa passa de <strong>10°C (283 K)</strong> a <strong>80°C (353 K)</strong> en cremar-se. Si inicialment ocupa <strong>2,2 L</strong>, quin volum tindrà?",
      inputLabel: "Volum final (L):",
      correctAnswer: 2.74,
      tolerance: 0.05,
      correctLaw: "C",
      solution: `Dades: V₁=2,2 L; T₁=283 K; T₂=353 K; P constant.
Llei de Charles: V₁/T₁=V₂/T₂ → V₂ = V₁·T₂ / T₁.
Càlcul: V₂ = 2,2·353 / 283 ≈ 2,74 L.
El gas s'expandeix en cremar-se.`
    },
    {
      title: "Màquina de Cafè",
      description: "El vapor d'una màquina de cafè té <strong>1,8 atm</strong> a <strong>110°C (383 K)</strong>. Si es refreda a <strong>95°C (368 K)</strong>, quina pressió tindrà?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 1.73,
      tolerance: 0.02,
      correctLaw: "G",
      solution: `Dades: P₁=1,8 atm; T₁=383 K; T₂=368 K; V constant.
Llei de Gay-Lussac: P₁/T₁=P₂/T₂ → P₂ = P₁·T₂ / T₁.
Càlcul: P₂ = 1,8·368 / 383 ≈ 1,73 atm.
La pressió del vapor baixa lleugerament.`
    },
    {
      title: "Airbag d'Automòbil",
      description: "Un airbag s'infla amb <strong>60 L</strong> de gas a <strong>3 atm</strong>. Si la pressió baixa a <strong>1,2 atm</strong>, quin volum tindrà?",
      inputLabel: "Volum final (L):",
      correctAnswer: 150,
      tolerance: 2,
      correctLaw: "B",
      solution: `Dades: V₁=60 L; P₁=3 atm; P₂=1,2 atm; T constant.
Llei de Boyle: P₁·V₁=P₂·V₂ → V₂ = P₁·V₁ / P₂.
Càlcul: V₂ = 3·60 / 1,2 = 150 L.
L'airbag s'expandeix molt en baixar la pressió.`
    },
    {
      title: "Globus Meteorològic 2",
      description: "Un globus meteorològic amb <strong>8 L</strong> d'heli a <strong>5°C (278 K)</strong> puja a l'atmosfera on la temperatura és <strong>-40°C (233 K)</strong>. Quin volum tindrà?",
      inputLabel: "Volum final (L):",
      correctAnswer: 6.71,
      tolerance: 0.1,
      correctLaw: "C",
      solution: `Dades: V₁=8 L; T₁=278 K; T₂=233 K; P constant.
Llei de Charles: V₁/T₁=V₂/T₂ → V₂ = V₁·T₂ / T₁.
Càlcul: V₂ = 8·233 / 278 ≈ 6,71 L.
El fred fa que el globus es contragui.`
    },
    {
      title: "Tanc de Propà",
      description: "Un tanc de propà té <strong>4,5 atm</strong> a <strong>15°C (288 K)</strong>. En un dia calorós a <strong>35°C (308 K)</strong>, quina pressió tindrà?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 4.81,
      tolerance: 0.05,
      correctLaw: "G",
      solution: `Dades: P₁=4,5 atm; T₁=288 K; T₂=308 K; V constant.
Llei de Gay-Lussac: P₁/T₁=P₂/T₂ → P₂ = P₁·T₂ / T₁.
Càlcul: P₂ = 4,5·308 / 288 ≈ 4,81 atm.
La pressió augmenta amb la calor.`
    },
    {
      title: "Compressor d'Aire",
      description: "Un compressor redueix <strong>20 L</strong> d'aire de <strong>1 atm</strong> a <strong>8 L</strong>. Quina pressió genera?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 2.5,
      tolerance: 0.1,
      correctLaw: "B",
      solution: `Dades: V₁=20 L; P₁=1 atm; V₂=8 L; T constant.
Llei de Boyle: P₁·V₁=P₂·V₂ → P₂ = P₁·V₁ / V₂.
Càlcul: P₂ = 1·20 / 8 = 2,5 atm.
La compressió augmenta la pressió.`
    },
    {
      title: "Forns Industrials",
      description: "Els gasos d'un forn passen de <strong>800°C (1073 K)</strong> a <strong>400°C (673 K)</strong>. Si inicialment ocupen <strong>12 L</strong>, quin volum tindrán?",
      inputLabel: "Volum final (L):",
      correctAnswer: 7.52,
      tolerance: 0.1,
      correctLaw: "C",
      solution: `Dades: V₁=12 L; T₁=1073 K; T₂=673 K; P constant.
Llei de Charles: V₁/T₁=V₂/T₂ → V₂ = V₁·T₂ / T₁.
Càlcul: V₂ = 12·673 / 1073 ≈ 7,52 L.
Els gasos es contrauen en refredar-se.`
    },
    {
      title: "Reactor Químic",
      description: "En un reactor, la pressió passa de <strong>6 atm</strong> a <strong>200°C (473 K)</strong> fins a <strong>300°C (573 K)</strong>. Quina serà la nova pressió?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 7.27,
      tolerance: 0.1,
      correctLaw: "G",
      solution: `Dades: P₁=6 atm; T₁=473 K; T₂=573 K; V constant.
Llei de Gay-Lussac: P₁/T₁=P₂/T₂ → P₂ = P₁·T₂ / T₁.
Càlcul: P₂ = 6·573 / 473 ≈ 7,27 atm.
L'escalfament augmenta la pressió.`
    },
    {
      title: "Pneumàtic de Camió",
      description: "Un pneumàtic de camió conté <strong>150 L</strong> d'aire a <strong>25°C (298 K)</strong>. A l'estiu, a <strong>45°C (318 K)</strong>, quin volum ocuparà?",
      inputLabel: "Volum final (L):",
      correctAnswer: 160.07,
      tolerance: 1,
      correctLaw: "C",
      solution: `Dades: V₁=150 L; T₁=298 K; T₂=318 K; P constant.
Llei de Charles: V₁/T₁=V₂/T₂ → V₂ = V₁·T₂ / T₁.
Càlcul: V₂ = 150·318 / 298 ≈ 160,07 L.
La calor fa que l'aire s'expandeixi.`
    },
    {
      title: "Extractor de Fums",
      description: "Un extractor comprimeix <strong>500 mL</strong> de fums de <strong>0,8 atm</strong> a <strong>200 mL</strong>. Quina pressió genera?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 2.0,
      tolerance: 0.05,
      correctLaw: "B",
      solution: `Dades: V₁=500 mL; P₁=0,8 atm; V₂=200 mL; T constant.
Llei de Boyle: P₁·V₁=P₂·V₂ → P₂ = P₁·V₁ / V₂.
Càlcul: P₂ = 0,8·500 / 200 = 2 atm.
La compressió augmenta la pressió dels fums.`
    },
    {
      title: "Cambra Frigorífica",
      description: "L'aire d'una cambra frigorífica passa de <strong>20°C (293 K)</strong> a <strong>-18°C (255 K)</strong> en un espai tancat. Si la pressió inicial era <strong>1,1 atm</strong>, quina serà la final?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 0.96,
      tolerance: 0.02,
      correctLaw: "G",
      solution: `Dades: P₁=1,1 atm; T₁=293 K; T₂=255 K; V constant.
Llei de Gay-Lussac: P₁/T₁=P₂/T₂ → P₂ = P₁·T₂ / T₁.
Càlcul: P₂ = 1,1·255 / 293 ≈ 0,96 atm.
El refredament redueix la pressió.`
    },
    {
      title: "Laboratori Escolar",
      description: "En un experiment escolar, <strong>75 mL</strong> de gas a <strong>1,2 atm</strong> es comprimeixen a <strong>25 mL</strong>. Quina pressió s'obté?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 3.6,
      tolerance: 0.1,
      correctLaw: "B",
      solution: `Dades: V₁=75 mL; P₁=1,2 atm; V₂=25 mL; T constant.
Llei de Boyle: P₁·V₁=P₂·V₂ → P₂ = P₁·V₁ / V₂.
Càlcul: P₂ = 1,2·75 / 25 = 3,6 atm.
La forta compressió triplica la pressió.`
    },
    {
      title: "Hivernacle",
      description: "L'aire d'un hivernacle s'escalfa de <strong>12°C (285 K)</strong> a <strong>28°C (301 K)</strong>. Si inicialment ocupa <strong>1000 L</strong>, quin volum tindrà?",
      inputLabel: "Volum final (L):",
      correctAnswer: 1056.14,
      tolerance: 5,
      correctLaw: "C",
      solution: `Dades: V₁=1000 L; T₁=285 K; T₂=301 K; P constant.
Llei de Charles: V₁/T₁=V₂/T₂ → V₂ = V₁·T₂ / T₁.
Càlcul: V₂ = 1000·301 / 285 ≈ 1056,14 L.
L'aire calent s'expandeix en el hivernacle.`
    },
    {
      title: "Cilindre de Soldadura",
      description: "Un cilindre de soldadura té <strong>8 atm</strong> a <strong>18°C (291 K)</strong>. Exposat al sol, arriba a <strong>50°C (323 K)</strong>. Quina pressió tindrà?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 8.88,
      tolerance: 0.1,
      correctLaw: "G",
      solution: `Dades: P₁=8 atm; T₁=291 K; T₂=323 K; V constant.
Llei de Gay-Lussac: P₁/T₁=P₂/T₂ → P₂ = P₁·T₂ / T₁.
Càlcul: P₂ = 8·323 / 291 ≈ 8,88 atm.
La calor solar augmenta la pressió perillosa.`
    },
    {
      title: "Màquina de Vapor",
      description: "Una màquina de vapor expandeix <strong>2 L</strong> de vapor de <strong>5 atm</strong> a <strong>1,5 atm</strong>. Quin volum ocuparà?",
      inputLabel: "Volum final (L):",
      correctAnswer: 6.67,
      tolerance: 0.1,
      correctLaw: "B",
      solution: `Dades: V₁=2 L; P₁=5 atm; P₂=1,5 atm; T constant.
Llei de Boyle: P₁·V₁=P₂·V₂ → V₂ = P₁·V₁ / P₂.
Càlcul: V₂ = 5·2 / 1,5 ≈ 6,67 L.
El vapor s'expandeix en baixar la pressió.`
    },
    {
      title: "Avió Comercial",
      description: "L'aire de la cabina d'un avió passa de <strong>1 atm</strong> a nivell del mar a <strong>0,75 atm</strong> en altitud. Si inicialment ocupava <strong>500 L</strong>, quin volum tindrà?",
      inputLabel: "Volum final (L):",
      correctAnswer: 666.67,
      tolerance: 5,
      correctLaw: "B",
      solution: `Dades: V₁=500 L; P₁=1 atm; P₂=0,75 atm; T constant.
Llei de Boyle: P₁·V₁=P₂·V₂ → V₂ = P₁·V₁ / P₂.
Càlcul: V₂ = 1·500 / 0,75 ≈ 666,67 L.
L'aire s'expandeix a gran altitud.`
    },
    {
      title: "Foguer de Gas",
      description: "El gas d'un foguer s'escalfa de <strong>15°C (288 K)</strong> a <strong>450°C (723 K)</strong> en cremar-se. Si inicialment té <strong>0,8 L</strong>, quin volum ocuparà?",
      inputLabel: "Volum final (L):",
      correctAnswer: 2.01,
      tolerance: 0.05,
      correctLaw: "C",
      solution: `Dades: V₁=0,8 L; T₁=288 K; T₂=723 K; P constant.
Llei de Charles: V₁/T₁=V₂/T₂ → V₂ = V₁·T₂ / T₁.
Càlcul: V₂ = 0,8·723 / 288 ≈ 2,01 L.
La combustió fa que el gas s'expandeixi molt.`
    },
    {
      title: "Cambra d'Assaig",
      description: "En una cambra d'assaig, la pressió d'un gas puja de <strong>2,2 atm</strong> a <strong>50°C (323 K)</strong> fins a <strong>100°C (373 K)</strong>. Quina serà la pressió final?",
      inputLabel: "Pressió final (atm):",
      correctAnswer: 2.54,
      tolerance: 0.05,
      correctLaw: "G",
      solution: `Dades: P₁=2,2 atm; T₁=323 K; T₂=373 K; V constant.
Llei de Gay-Lussac: P₁/T₁=P₂/T₂ → P₂ = P₁·T₂ / T₁.
Càlcul: P₂ = 2,2·373 / 323 ≈ 2,54 atm.
L'escalfament augmenta la pressió del gas.`
    }
  ];

  // Don't edit below this line
</script>
<style>
  body {
    font-family: system-ui, Arial;
    line-height: 1.5;
    padding: 20px;
    background: #f5f7fa;
    color: #111;
  }

  h1 {
    text-align: center;
  }

  .carrusel {
    position: relative;
    max-width: 800px;
    margin: 20px auto;
    overflow: hidden;
  }

  .slides {
    display: flex;
    transition: transform 0.4s ease;
  }

  .slide {
    flex: 0 0 100%;
    padding: 20px;
    box-sizing: border-box;
  }

  .problema {
    background: white;
    border: 1px solid #ddd;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
  }

  label {
    display: block;
    margin: 8px 0 4px;
    font-weight: 600;
  }

  input[type="number"],
  select {
    padding: 8px;
    width: 180px;
  }

  button {
    margin: 6px 6px 0 0;
    padding: 8px 12px;
    border-radius: 6px;
    border: 1px solid #ccc;
    background: #f0f0f0;
    cursor: pointer;
  }

  .feedback {
    margin-top: 10px;
    font-weight: 600;
  }

  .correcte {
    color: #0b8457;
  }

  .incorrecte {
    color: #b71c1c;
  }

  .solucio {
    margin-top: 12px;
    background: #f7f9fb;
    padding: 10px;
    border-radius: 6px;
    border: 1px dashed #ccd;
    display: none;
    white-space: pre-wrap;
  }

  .controls {
    text-align: center;
    margin-top: 12px;
  }

  .controls button {
    background: #e7ecf3;
    border: 1px solid #bbb;
  }

  .nota {
    font-size: 0.9em;
    color: #555;
    text-align: center;
    margin-top: 20px;
  }
</style>
<h1>Problemes autocorrectius: Lleis dels gasos (3r ESO)</h1>

<div class="carrusel">
  <div class="slides" id="slides">
    <!-- Slides will be generated dynamically from questionsData and placed here -->
  </div>
  <div class="controls">
    <button onclick="prevSlide()">⬅️ Anterior</button>
    <button onclick="nextSlide()">Següent ➡️</button>
  </div>
</div>

<p class="nota">El sistema comprova la llei seleccionada i el resultat numèric (±0,05). Pots mostrar/ocultar la
  solució pas a pas.</p>

<script>
  // Global variable to store the selected questions for this session
  let selectedQuestions = [];

  // Function to shuffle array and pick n random items
  function getRandomQuestions(questions, n) {
    if (n <= 0 || n >= questions.length) {
      return [...questions]; // Return all questions if n is invalid
    }

    // Create a copy and shuffle it
    const shuffled = [...questions];
    for (let i = shuffled.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }

    return shuffled.slice(0, n);
  }

  // Generate slides from questionsData
  function generateSlides() {
    const slidesContainer = document.getElementById("slides");
    slidesContainer.innerHTML = '';

    // Select random questions if not already selected
    if (selectedQuestions.length === 0) {
      selectedQuestions = getRandomQuestions(questionsData, numberOfQuestionsToShow);
    }

    selectedQuestions.forEach((question, index) => {
      const questionId = index + 1;
      const slideHTML = `
          <div class="slide">
            <div class="problema">
              <h2>Problema ${questionId} — ${question.title}</h2>
              <p>${question.description}</p>
              <label for="l${questionId}">Llei aplicada:</label>
              <select id="l${questionId}">
                <option value="">-- Selecciona --</option>
                <option value="B">Boyle</option>
                <option value="C">Charles</option>
                <option value="G">Gay-Lussac</option>
              </select>
              <label for="a${questionId}">${question.inputLabel}</label>
              <input id="a${questionId}" type="number" step="0.01">
              <div>
                <button onclick="check(${questionId})">Comprova</button>
                <button onclick="showSolution('s${questionId}')">Mostra solució</button>
              </div>
              <div id="f${questionId}" class="feedback"></div>
              <div id="s${questionId}" class="solucio">${question.solution}</div>
            </div>
          </div>
        `;
      slidesContainer.innerHTML += slideHTML;
    });
  }

  // Check if two numbers are nearly equal within tolerance of each other
  function nearlyEqual(a, b, tolerance) {
    return Math.abs(a - b) <= tolerance;
  }

  function showMessage(id, msg, ok) {
    const el = document.getElementById(id);
    el.innerHTML = msg;
    el.className = "feedback " + (ok ? "correcte" : "incorrecte");
  }

  // Js expects 1.23, Handle 1,23 transparently
  function parseInput(id) {
    const v = document.getElementById(id).value;
    if (v === "") return null;
    return Number(v.replace(",", "."));
  }

  function showSolution(id) {
    const el = document.getElementById(id);
    el.style.display = (el.style.display === "block") ? "none" : "block";
  }

  function check(n) {
    const inp = parseInput("a" + n);
    const law = document.getElementById("l" + n).value;

    if (inp === null || law === "") {
      showMessage("f" + n, "Cal posar resultat i llei", false);
      return;
    }

    const question = selectedQuestions[n - 1]; // Use selectedQuestions instead of questionsData
    if (!question) return;

    const okNum = nearlyEqual(inp, question.correctAnswer, question.tolerance || defaultTolerance);
    const okLaw = (law === question.correctLaw);

    if (okNum && okLaw) {
      showMessage("f" + n, "Correcte ✅", true);
      return;
    }

    let messages = [];
    if (!okLaw) {
      messages.push("La llei no és la correcta ❌");
    }

    if (!okNum) {
      messages.push("Resultat incorrecte ❌");
    }

    showMessage("f" + n, messages.join("<br />"), false);
  }

  // Carousel functionality
  let current = 0;
  const slides = document.getElementById("slides");

  function updateSlide() {
    const total = selectedQuestions.length;
    slides.style.transform = "translateX(-" + (current * 100) + "%)";
  }

  function prevSlide() {
    if (current > 0) {
      current--;
      updateSlide();
    }
  }

  function nextSlide() {
    if (current < selectedQuestions.length - 1) {
      current++;
      updateSlide();
    }
  }

  // Function to regenerate random questions (useful for "New Quiz" functionality)
  function regenerateQuestions() {
    selectedQuestions = getRandomQuestions(questionsData, numberOfQuestionsToShow);
    current = 0;
    generateSlides();
    updateSlide();
  }

  // Initialize the application
  document.addEventListener('DOMContentLoaded', function () {
    generateSlides();
    updateSlide();
  });
</script>
